---
title: "Data Visualisation"
output: 
  html_document: 
    highlight: tango
    theme: readable
runtime: shiny
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

This is an Rmarkdown document, made using R programming language.
This file will be updated consequently, in here you will find interesing visualizations concerning some examples from the Tutorial 2. 
Feel free to ask for help, or information, or if you want to learn how to do these amazing documents yourselves ;) 

## Histograms and the number of classes

```{r include=FALSE}
temperatures <- tibble(temp = c(42, 70, 64, 47, 66, 69, 73, 38, 48, 25,
       55, 85, 10, 24, 45, 31, 62, 47, 63, 84, 
       16, 40, 81, 15, 35, 17, 40, 36, 44, 17, 
       38, 79, 35, 36, 23, 64, 75, 53, 31, 60, 
       31, 38, 52, 16, 81, 12, 61, 43, 30, 33)) %>% rowid_to_column()
```

#### Example in Exercice 1


```{r include=FALSE}
binFreqTable <- function(x, bins) {

  freq = hist(x, breaks=bins, include.lowest=TRUE, plot=FALSE)

  ranges = paste(head(freq$breaks,-1), freq$breaks[-1], sep=" - ")

  return(data.frame(range = ranges, frequency = freq$counts))

}
```

The table below describes the data, we mean by q1 and q3 the quartiles of first and third order (25% of data and 75% of data reqpectively) 

```{r echo=FALSE}
summary(temperatures$temp) %>% broom::tidy() %>% knitr::kable()
```

The table below contains the classes (5 as the exercice demanded)

```{r echo=FALSE}
binFreqTable(temperatures$temp, seq(10, 85, by = 15)) %>% knitr::kable()
```

Change the number of classes option to see the histogram

```{r eruptions, echo=FALSE}
inputPanel(
  selectInput("n_breaks", label = "Number of classes",
              choices = c(5:20), selected = 5)
)

renderPlot({
  temperatures %>%
    ggplot(aes(x = temp)) + 
    geom_histogram(bins = input$n_breaks) +
    geom_freqpoly(size = 2, colour = "skyblue2", bins = input$n_breaks) +
    labs(title = "Histogram of Temperature in Fahrenheit", x= "FÂ°", y = "frequency")

  
})
```

